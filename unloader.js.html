<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: resolver/unloader.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: resolver/unloader.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>'use strict';
/**
 * @fileOverview The base-resolver/unloader module is used for registering unloaders. This module is responsible for
 * invoking all handlers registered to unload dependency and executing them in the proper sequence on unload.
 * @module base-resolver/unloader
 * @requires q
 */
var q = require('q');
var logger = require('base.logger')('RESOLVER/unloader');
/**
 * This function creates a new Unloader and returns it.
 * @returns {module:base-resolver/unloader~Unloader} the resolver with one resolve method
 */
module.exports = function () {
    var unloaders = [];
    /**
     * Unloader is returned by {@link module:base-resolver/unloader}
     * @namespace module:base-resolver/unloader~Unloader
     */
    return {
        /**
         * This function is used to register a callback function to the unloader. We inject this function as a
         * dependency when unloader is requested by a component.
         * @param {callback} callback - the function to execute when resolver is unloaded.
         * @memberof module:base-resolver/unloader~Unloader
         */
        register: function (callback) {
            logger.log('registering unloader');
            unloaders.push(callback);
        },
        /**
         * This function is called when the resolver is unloaded.
         * @return {q} a promise that resolves when all callbacks registeres are executed.
         * @memberof module:base-resolver/unloader~Unloader
         */
        unload: function () {
            var retVal = q(true);
            var eatError = function (unloaderFn) {
                return function (error) {
                    logger.error('error while unloading...');
                    logger.error(error);
                    return unloaderFn();
                };
            };
            var unloaderFn;
            logger.log('executing unloaders...');
            while (unloaders.length) {
                unloaderFn = unloaders.pop();
                retVal = retVal.then(unloaderFn, eatError(unloaderFn));
            }
            return retVal.then(
                function () {
                    logger.log('All registered unloaders executed successfully.');
                }, eatError(
                    function () {
                        return;
                    }
                )
            );
        }
    };
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-base-resolver.html">base-resolver</a></li><li><a href="configurations.html">base-resolver/configurations</a></li><li><a href="resolution-provider.html">base-resolver/resolution-provider</a></li><li><a href="unloader.html">base-resolver/unloader</a></li><li><a href="utils.html">base-resolver/utils</a></li></ul><h3>Namespaces</h3><ul><li><a href="configurations-ConfigurationManager.html">ConfigurationManager</a></li><li><a href="resolution-provider-ResolutionProvider.html">ResolutionProvider</a></li><li><a href="unloader-Unloader.html">Unloader</a></li><li><a href="module-base-resolver-Resolver.html">Resolver</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Sat Sep 20 2014 22:26:28 GMT-0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
